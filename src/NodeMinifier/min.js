const app=plunc.create("app");app.service("AppService",((RequesterEngine_1,AppConfig_1,TemplateData_1)=>{const t=RequesterEngine_1.RequesterEngine,e=AppConfig_1,n=TemplateData_1.TemplateData;return{bootstrap:async()=>{new e,await t.get();n.set("view","default")}}})),app.service("RequesterEngine_1",((TaskManager_1,IAuthTokenManager_1)=>{const t=TaskManager_1,e=IAuthTokenManager_1.IAuthTokenManager;var n;return function(n){class a{constructor(t,e,n){this.token=t,this.id=e,this.status=n,this.created=Date.now()}export(){return{tkn:this.token,uid:this.id,ust:this.status,cat:this.created}}}const s="rqssn",r=new t;let i=null;const o=async t=>{try{const n=await e.refresh();return t.tkn=n,localStorage.setItem(s,JSON.stringify(t)),i={tkn:n,uid:t.uid,ust:t.ust,cat:t.cat},i}catch(t){throw console.error(t),new Error("x00xx1REE107")}},c=()=>{const t=localStorage.getItem(s);if(null===t)return null;let e=null;if(null!==t){if(e=JSON.parse(t),null===e)throw new Error("x00xx1REE100");if(!("tkn"in e))throw new Error("x00xx1REE101");if(!("uid"in e))throw new Error("x00xx1REE102");if(!("ust"in e))throw new Error("x00xx1REE103")}return e};n.create=async(t,n,r)=>{if("idauth"===t){const t=await e.get().withEmailAndPassword(n,r);if(!t.is_user_registered)throw localStorage.removeItem(s),new Error("x00xx1REE104");const i=t.access_type;if("prohibited"===i)return localStorage.removeItem(s),t;if("allowed"===i||"limited"===i){const e=new a(t.token,t.user_id,t.user_status);return localStorage.setItem(s,JSON.stringify(e.export())),t}return t}throw new Error("x00xx1REE105")},n.get=async()=>new Promise((async(t,e)=>{try{const n=c();if(null===n)throw new Error("x00xx1REE106");const a=n.uid;r.exists(a)||r.register(a,(()=>o(n))),r.listen(a,(e=>t(e)),(t=>e(t)))}catch(t){e(t)}})),n.override=(t,e,n)=>{const r=new a(n,t,e);localStorage.setItem(s,JSON.stringify(r.export()))},n.active=async()=>new Promise((async(t,e)=>{try{const e=c();if(null===e)return void t(!1);const n=e.uid;r.exists(n)||r.register(n,(()=>o(e))),r.listen(n,(e=>t(!0)),(e=>t(!1)))}catch(e){t(!1)}})),n.end=()=>{localStorage.removeItem(s)},n.refresh=()=>{const t=c();if(null===t)throw new Error("x00xx1REE106");setInterval((()=>{o(t)}),42e4)}}(n||(n={})),{RequesterEngine:n}})),app.factory("TaskManager_1",(EventManager_1=>{const t=EventManager_1.EventManager;return class{constructor(){this.tasks={}}register(e,n){e in this.tasks||(this.tasks[e]={eventids:{success:t.register(),fail:t.register()},status:"new",task:n,data:null,error:null})}exists(t){return t in this.tasks}run(e){this.tasks[e].task().then((n=>{this.tasks[e].status="completed",this.tasks[e].data=n,t.dispatch(this.tasks[e].eventids.success,n)})).catch((n=>{this.tasks[e].status="completed",this.tasks[e].error=new Error(n.message),t.dispatch(this.tasks[e].eventids.fail,this.tasks[e].error)}))}listen(e,n,a){if(!(e in this.tasks))throw new Error("x00xx1TMS100");if(t.subscribe(this.tasks[e].eventids.success,n),void 0!==a&&t.subscribe(this.tasks[e].eventids.fail,a),"new"===this.tasks[e].status)return this.tasks[e].status="ongoing",void this.run(e);if("ongoing"!==this.tasks[e].status&&"completed"===this.tasks[e].status){const t=this.tasks[e].error;if(null!==t){if(void 0===a)return;return void a(t)}n(this.tasks[e].data)}}}})),app.service("EventManager_1",(()=>{var t;return function(t){let e=0;const n={};t.register=()=>{e++;const t=e.toString();return n[t]=[],t},t.subscribe=(t,e)=>{t in n||(n[t]=[]),n[t].push(e)},t.dispatch=(t,...e)=>{if(t in n)for(let a=0;a<n[t].length;a++){const s=n[t][a];try{s(...e)}catch(t){console.error(t)}}}}(t||(t={})),{EventManager:t}})),app.service("IAuthTokenManager_1",((AppConfig_1,HttpRequest_1)=>{const t=AppConfig_1,e=HttpRequest_1.HttpRequest;var n;return function(n){const a=new t,s={withEmailAndPassword:async(t,n)=>await e.post({host:a.iauth.root,path:"/identity-authority/user/token/generate",params:{},data:{email_address:t,password:n},withoutToken:!0})},r={asEmail:async t=>await e.post({host:a.iauth.root,path:"/identity-authority/user/token/email/send",params:{},data:{email_address:t},withoutToken:!0})};n.get=()=>s,n.refresh=async()=>(await e.get({host:a.iauth.root,path:"/identity-authority/user/token/refresh",params:{},data:{}})).token,n.send=()=>r}(n||(n={})),{IAuthTokenManager:n}})),app.factory("AppConfig_1",(()=>class{constructor(){const t=window;"deployment"in t&&"name"in t.deployment?"production"===t.deployment.name&&(this.buildMode="production",this.iauth={root:"http://localhost:5458"},this.indexer={root:"http://localhost:8000",namespace:"eo7yQi4NglbV5OOWG0v7SgT1y4Rof6Rg"},this.tripengine={root:"http://localhost:5458"}):(this.buildMode="default",this.iauth={root:"http://localhost:5458"},this.indexer={root:"http://localhost:8000",namespace:"eo7yQi4NglbV5OOWG0v7SgT1y4Rof6Rg"},this.tripengine={root:"http://localhost:5458"})}})),app.service("HttpRequest_1",(()=>{var t;return function(t){const e=(t,e)=>{const n=e.host+(t=>{const e=t.params;let n=t.path;for(const t in e){const a=`:${t}`;n.includes(a)&&(n=n.split(a).join(e[t]))}return n})(e);return new Promise(((a,s)=>{((t,e,n)=>new Promise(((a,s)=>{let r="",i=!1,o=!0;void 0!==n.data&&(n.data instanceof FormData?(r=n.data,i=!1,o=!1):(r=JSON.stringify(n.data),i="application/json",o=!0));const c={};if(!n.withoutToken){const t=localStorage.getItem("rqssn");if(null===t)return void s(new Error("x00xx1HPQ100"));const e=JSON.parse(t);"tkn"in e&&(c["X-Requester-Token"]=e.tkn)}!1!==i&&(c["content-type"]=i);const u={method:t,headers:c};"GET"!==t&&(u.body=r),fetch(e,u).then((async t=>{const e=n.isJsonRes??!0,r=t.headers.get("Content-Type");let i;if(r&&r.includes("application/json")){if(!e)return void s(new Error("x00xx1HPQ101"));i=await t.json()}else i=JSON.parse(await t.text());200===t.status?a(i):s(new Error(`x00xx1HPQ103 ${t.status} ${t.statusText}`))}))})))(t,n,e).then(a).catch(s)}))};t.get=t=>e("GET",t),t.post=t=>e("POST",t),t.put=t=>e("PUT",t),t.patch=t=>e("PATCH",t),t.remove=t=>e("DELETE",t)}(t||(t={})),{HttpRequest:t}})),app.service("TemplateData_1",(()=>{var t;return function(t){const e={};t.set=(t,n)=>{void 0===e[t]&&(e[t]=n)},t.get=()=>e}(t||(t={})),{TemplateData:t}})),app.component("AppRouter_6",((StateManager_1,$scope,$patch,$app,AppService,ActivationEvent_1,RouteService_1,TemplateData_1)=>{const t=StateManager_1.StateManager,e=ActivationEvent_1.ActivationEvent,n=RouteService_1.RouteService,a=TemplateData_1.TemplateData,s=async()=>{try{await t.switch("loading"),await AppService.bootstrap();$scope.template=a.get(),await t.switch("active"),$patch(),e.dispatch()}catch(e){if(console.error(e),("x00xx1REE101"===e.message||"x00xx1REE106"===e.message||"x00xx1REE107"===e.message)&&n.config().gatekeep)return void n.reroute("login");if("x00xx1TNTSVC100"===e.message&&n.config().gatekeep)return void n.reroute("access/library");await t.switch("error"),$patch()}};var r;return function(t){$app.ready(s),t.render=()=>{}}(r||(r={})),{AppRouter:r}})),app.helper("StateManager_1",(($scope,$patch)=>{const t=new class{constructor(){this.callbacks={},this.blockname=null}scope(t){this.scopeobj=t}patch(t){this.patchapi=t}block(t){this.blockname=t}register(t,e){return t in this.callbacks?(console.error(`Duplicate callback for component state "${t}"`),this):(this.callbacks[t]=e,this)}switch(t){return new Promise((async(e,n)=>{try{this.scopeobj.state=t,await this.patchapi(),t in this.callbacks&&await this.callbacks[t](),e()}catch(t){n(t)}}))}get(){return this.scopeobj.state}};return t.scope($scope),t.patch($patch),{StateManager:t}})),app.service("ActivationEvent_1",(EventManager_1=>{const t=EventManager_1.EventManager;var e;return function(e){const n=t.register();e.subscribe=e=>{t.subscribe(n,e)},e.dispatch=()=>{t.dispatch(n)}}(e||(e={})),{ActivationEvent:e}})),app.service("RouteService_1",(()=>{var t;return function(t){const e={gatekeep:!1};t.gatekeep=()=>{e.gatekeep=!0},t.config=()=>e,t.delay=t=>new Promise((async(e,n)=>{setTimeout((()=>{e()}),t)})),t.reroute=t=>{location.href=`/${t}.html`}}(t||(t={})),{RouteService:t}})),app.component("Sidebar_3",((StateManager_1,$scope,ActivationEvent_1,SidebarControl_1)=>{const t=StateManager_1.StateManager,e=ActivationEvent_1.ActivationEvent,n=SidebarControl_1.SidebarControl;var a;return e.subscribe((async()=>{n.option.preset("Dashboard","")})),function(e){e.render=async()=>{await t.switch("active")}}(a||(a={})),{Sidebar:a}})),app.service("SidebarControl_1",(EventManager_1=>{const t=EventManager_1.EventManager;var e;return function(e){const n={namespace:"",option:""},a=t.register(),s=t.register();e.option={select:(e,s)=>{n.namespace=e,n.option=s,t.dispatch(a,n)},preset:(e,a)=>{n.namespace=e,n.option=a,t.dispatch(s,n)}},e.events={when:{option:{selected:e=>{t.subscribe(a,e)},preset:e=>{t.subscribe(s,e)}}}},e.mobile={open:()=>{const t=document.querySelector(".--sidebar-control");console.log(t),null!==t&&t.setAttribute("style","margin-left:0px")},close:()=>{const t=document.querySelector(".--sidebar-control");null!==t&&t.removeAttribute("style")}}}(e||(e={})),{SidebarControl:e}})),app.component("Header_6",((ThemeSelector_1,$scope,$patch,ActivationEvent_1,RequesterEngine_1,TemplateData_1,SidebarControl_1,TenantService_1,UserService_1,Hamburger_6)=>{const t=ThemeSelector_1.ThemeSelector,e=ActivationEvent_1.ActivationEvent,n=RequesterEngine_1.RequesterEngine,a=TemplateData_1.TemplateData,s=SidebarControl_1.SidebarControl,r=TenantService_1.TenantService,i=UserService_1.UserService,o=Hamburger_6.Hamburger,c=$scope;c.template={without_tenant_context:"false"};var u;return e.subscribe((async()=>{if(t.render(),!await n.active())return;const e=await n.get();var s;if(c.user=await i.get.snippet(e.uid),"without_tenant_context"in(s=a.get())&&"true"===s.without_tenant_context&&(c.template.without_tenant_context="true"),"true"===c.template.without_tenant_context)return void await $patch();const o=await r.get.catalog(e);c.tenant=o.tenant,await $patch()})),o.events.when.isClickedOpen(s.mobile.open),o.events.when.isClickedClose(s.mobile.close),function(t){t.render=async()=>{}}(u||(u={})),{Header:u}})),app.helper("ThemeSelector_1",(($scope,$patch)=>{var t;return function(t){const e=$scope,n=["light","dark"],a=window,s=async t=>{e.ThemeSelector.isDarkTheme="dark"===t;const s=n.filter((e=>e!==t)),r=document.querySelector("body");null!==r&&(s.forEach((t=>{r.classList.remove(t)})),r.classList.add(t),localStorage.setItem("slate-theme",t),a.slate.theme.name=t,await $patch("/Plugins/ThemeSelector/"))};e.ThemeSelector={isDarkTheme:"dark"===a.slate.theme.name,switchTheme:()=>{e.ThemeSelector.isDarkTheme?s("dark"):s("light")}},t.render=()=>{}}(t||(t={})),{ThemeSelector:t}})),app.service("TenantService_1",((AppConfig_1,TaskManager_1,IAuthTenantManager_1,TenantIndexService_1,HttpRequest_1,RequesterEngine_1,RouteService_1)=>{const t=AppConfig_1,e=TaskManager_1,n=IAuthTenantManager_1.IAuthTenantManager,a=TenantIndexService_1.TenantIndexService,s=HttpRequest_1.HttpRequest,r=RequesterEngine_1.RequesterEngine,i=RouteService_1.RouteService,o=new t,c="tntid",u={snippets:new e};var p;return function(t){t.get={catalog:t=>new Promise((async(e,n)=>{const s=localStorage.getItem(c);if(null===s)return void n(new Error("x00xx1TNTSVC100"));const r=async()=>{const e=await a.stores(s,t);return{stores:e.stores.snippets.map((t=>({entity_id:t.entity_id,...t.data}))),tenant:{entity_id:e.tenant.entity_id,name:e.tenant.data.name,profile_photo:e.tenant.data.profile_photo,cover_photo:e.tenant.data.cover_photo}}};u.snippets.exists(s)||u.snippets.register(s,r),u.snippets.listen(s,e,n)}))},t.login=async(t,e)=>{const a=await n.certify.access(e),u=await s.post({host:o.tripengine.root,path:"/trip-engine/organizations/:organizationId/token",params:{organizationId:e},data:{access_certification_token:a.access_certification_token}});r.override(t.uid,t.ust,u.upgraded_token),localStorage.setItem(c,e),i.reroute("index")}}(p||(p={})),{TenantService:p}})),app.service("IAuthTenantManager_1",((AppConfig_1,HttpRequest_1)=>{const t=AppConfig_1,e=HttpRequest_1.HttpRequest,n=new t;var a;return function(t){t.certify={access:async t=>e.post({host:n.iauth.root,path:"/identity-authority/tenants/:tenantId/access/certify",params:{tenantId:t},data:{audience:location.href}})}}(a||(a={})),{IAuthTenantManager:a}})),app.service("TenantIndexService_1",((AppConfig_1,HttpRequest_1)=>{const t=AppConfig_1,e=HttpRequest_1.HttpRequest,n=new t;var a;return function(t){t.snippet=async t=>{const a=await e.get({host:n.indexer.root,path:"/:namespace/identity-authority/tenant/retrieve/snippet?id=:id",params:{namespace:n.indexer.namespace,id:t},data:{},withoutToken:!0});if(null!==a.tenant.error)throw console.error(new Error(a.tenant.error)),new Error("x00xx1TNTIS100");return{entity_id:t,name:a.tenant.data.name,profile_photo:a.tenant.data.profile_photo,cover_photo:a.tenant.data.cover_photo}},t.stores=async(t,a)=>await e.get({host:n.indexer.root,path:"/:namespace/trip-engine/organization/stores?id=:id&token=:token",params:{namespace:n.indexer.namespace,id:t,token:a.tkn},withoutToken:!0})}(a||(a={})),{TenantIndexService:a}})),app.service("UserService_1",((TaskManager_1,UserIndexService_1)=>{const t=TaskManager_1,e=UserIndexService_1.UserIndexService,n={snippets:new t,accesses:new t};var a;return function(t){t.get={snippet:t=>new Promise((async(a,s)=>{const r=async()=>e.snippet(t);n.snippets.exists(t)||n.snippets.register(t,r),n.snippets.listen(t,a,s)}))},t.list={access:async t=>new Promise((async(a,s)=>{const r=async()=>e.access.tenant(t);n.accesses.exists(t.uid)||n.accesses.register(t.uid,r),n.accesses.listen(t.uid,a,s)}))}}(a||(a={})),{UserService:a}})),app.service("UserIndexService_1",((AppConfig_1,HttpRequest_1)=>{const t=AppConfig_1,e=HttpRequest_1.HttpRequest,n=new t;var a;return function(t){t.snippet=async t=>{const a=n.indexer.namespace;return(await e.get({host:n.indexer.root,path:"/:namespace/identity-authority/user/retrieve/snippet?id=:id",params:{namespace:a,id:t},data:{},withoutToken:!0})).user.data},t.access={tenant:async t=>{const a=n.indexer.namespace;return(await e.get({host:n.indexer.root,path:"/:namespace/identity-authority/user/access/tenants?id=:id&token=:token",params:{namespace:a,id:t.uid,token:t.tkn},data:{},withoutToken:!0})).tenants.snippets.map((t=>({entity_id:t.entity_id,name:t.data.name,profile_photo:t.data.profile_photo,cover_photo:t.data.cover_photo})))}}}(a||(a={})),{UserIndexService:a}})),app.component("Hamburger_6",(($scope,$patch,EventManager_1)=>{const t=EventManager_1.EventManager,e=t.register(),n=t.register(),a=$scope;var s;return a.state="closed",a.toggle=async()=>{"closed"===a.state?(a.state="opened",t.dispatch(e)):(a.state="closed",t.dispatch(n)),await $patch()},function(a){a.events={when:{isClickedOpen:n=>{t.subscribe(e,n)},isClickedClose:e=>{t.subscribe(n,e)}}}}(s||(s={})),{Hamburger:s}})),app.component("CreateTour_1",((StateManager_1,$scope,ActivationEvent_1,JoinersCount_1,TourDuration_1,TourPricing_1)=>{const t=StateManager_1.StateManager,e=ActivationEvent_1.ActivationEvent,n=JoinersCount_1.JoinersCount,a=TourDuration_1.TourDuration,s=TourPricing_1.TourPricing;var r;return e.subscribe((async()=>{await t.switch("active"),await a.render("1D1N"),await n.render(2),await s.render("0","0")})),function(e){e.render=async()=>{await t.switch("active")}}(r||(r={})),{CreateTour:r}})),app.component("JoinersCount_1",((StateManager_1,IconButtonUI_1,$scope,$patch)=>{const t=StateManager_1.StateManager,e=IconButtonUI_1.IconButtonUI,n=$scope;var a;return e.bind(n,"IconButtonHelper"),n.add=async()=>{n.value++,$patch("/JoinersCountEditor/Preview/")},n.subtract=async()=>{n.value<3||(n.value--,$patch("/JoinersCountEditor/Preview/"))},function(e){e.render=async e=>{await t.switch("active"),n.value=e,await t.switch("active")}}(a||(a={})),{JoinersCount:a}})),app.helper("IconButtonUI_1",(()=>{var t;return function(t){t.bind=(t,e)=>{t[e]={isActive:t=>t?"--icon-button-ui-active":"--icon-button-ui-disabled"}}}(t||(t={})),{IconButtonUI:t}})),app.component("TourDuration_1",((StateManager_1,IconButtonUI_1,$scope)=>{const t=StateManager_1.StateManager,e=IconButtonUI_1.IconButtonUI,n=$scope;e.bind(n,"IconButtonHelper");const a=(t,e)=>{const n={day:"day",night:"night"};return t>1&&(n.day=`${n.day}s`),e>1&&(n.night=`${n.night}s`),`${t} ${n.day} / ${e} ${n.night}`},s=(t,e)=>` ${t}D${e}N`;var r;return n.subtract=async()=>{n.days<2||(n.days===n.nights?n.nights--:n.days>n.nights&&n.days--,n.humanReadable=a(n.days,n.nights),n.notation=s(n.days,n.nights),await t.switch("active"))},n.add=async()=>{n.days===n.nights?n.days++:n.days>n.nights&&n.nights++,n.humanReadable=a(n.days,n.nights),n.notation=s(n.days,n.nights),await t.switch("active")},function(e){e.render=async e=>{const r=(t=>{const[e,n]=t.split("D"),a=n.split("N")[0];return{day:parseInt(e),night:parseInt(a)}})(e);n.days=r.day,n.nights=r.night,n.notation=s(n.days,n.nights),n.humanReadable=a(n.days,n.nights),await t.switch("active")}}(r||(r={})),{TourDuration:r}})),app.component("TourPricing_1",((IconButtonUI_1,$scope,$patch,ColorPicker_1)=>{const t=IconButtonUI_1.IconButtonUI,e=ColorPicker_1.ColorPicker,n=$scope;t.bind(n,"IconButtonHelper"),n.price={total:"0",reservation:"0",calculate:async()=>{const t=parseInt(n.price.total);parseInt(n.price.reservation)>t||await $patch()}};const a="/TourPricingEditor/FullPayment/";var s;return n.FullPayment={daysBeforeTrip:{add:async()=>{n.FullPayment.daysBeforeTrip.value>15||(n.FullPayment.daysBeforeTrip.value++,n.FullPayment.daysBeforeTrip.word=n.FullPayment.daysBeforeTrip.value>1?"days":"day",$patch(a))},subtract:async()=>{n.FullPayment.daysBeforeTrip.value<2||(n.FullPayment.daysBeforeTrip.value--,n.FullPayment.daysBeforeTrip.word=n.FullPayment.daysBeforeTrip.value>1?"days":"day",$patch(a))},value:1,word:"day"},selectOption:async t=>{n.FullPayment.onsite=t,$patch(a)},optionUI:{shouldHighlight:t=>t?e.pick("background-color-primary")??"":"",shouldGrayout:t=>t?e.pick("color-gray-scale")??"":"",shouldHide:t=>t?"--hide-days-selector":""},onsite:!1},function(t){t.render=async(t,e)=>{n.price.total=t,n.price.reservation=e,n.state="active",await $patch()}}(s||(s={})),{TourPricing:s}})),app.service("ColorPicker_1",(()=>{var t;return function(t){t.pick=t=>{const e=document.getElementById("slate_color_palette");if(null===e)return null;const n=e.querySelector(`[data-color-id="${t}"]`);if(null===n)return null;const a=n.getAttribute("class");return null===a?null:a.trim()}}(t||(t={})),{ColorPicker:t}})),app.component("PandoraSidebar_4",(($scope,$patch,$block,ColorPicker_1,SidebarControl_1)=>{const t=ColorPicker_1.ColorPicker,e=SidebarControl_1.SidebarControl,n=$scope;n.selected={namespace:"",option:""},e.events.when.option.preset((async t=>{$scope.selected=t,await $patch(),setTimeout(a,100)})),n.select={option:async(t,s)=>{const r={namespace:t,option:s};n.selected=r,await $patch(),e.option.select(t,s),a()}},n.isActive={option:(e,a)=>{if(e===n.selected.namespace&&a===n.selected.option){const e=t.pick("background-color-gray-scale-extra-light");t.pick("color-elegent-dark");return`${e}`}return""}};const a=()=>{$block("/PandoraSidebar/Main/",(t=>{const e=t.$element.querySelector(`input[value="${n.selected.namespace}"]`);null!==e&&(e.checked=!0)}))};return{render:()=>{}}}));